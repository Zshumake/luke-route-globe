<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåç Luke's Routes - Minimal Test</title>
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.111/Build/Cesium/Cesium.js"></script>
    <link href="https://cesium.com/downloads/cesiumjs/releases/1.111/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="0">
    <meta http-equiv="pragma" content="no-cache">
    <style>
        html, body, #cesiumContainer {
            width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden;
        }
        body { font-family: Arial, sans-serif; background: #000; }
        #status {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div id="status">Initializing minimal globe test...</div>
    <div id="cesiumContainer"></div>

    <script>
        console.log('üåç Starting minimal Luke Route Globe test...');
        
        // CRITICAL: Set token but don't use Ion assets
        Cesium.Ion.defaultAccessToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIyNGM2ZmUwZC0zNmI5LTQ4MTQtYjkyNy1kZTMyNTc0MWIyYWUiLCJpZCI6MzM2NzUyLCJpYXQiOjE3NTY1NTU3OTh9.zrnBs58tnAJxGy2FWSpWP5KD8JRTCskZJ1sMt3rUsT8';

        async function initializeMinimalGlobe() {
            try {
                console.log('üîß MINIMAL GLOBE DEBUG START');
                console.log('üîß Cesium version:', Cesium.VERSION);
                console.log('üîß Ion token set:', !!Cesium.Ion.defaultAccessToken);
                document.getElementById('status').textContent = 'Creating imagery provider...';
                
                // Try the simplest possible approach first
                let imageryProvider;
                
                try {
                    // Option 1: Direct Bing Maps (should work)
                    console.log('üîß Trying direct Bing Maps...');
                    console.log('üîß Bing API Key present:', !!('AqTGBsziZHIJYYxgivLBf0hVdrAk9mWO5cQcb8Yux8sW5M8c8opEC2lZqKR1ZZXf'));
                    imageryProvider = await Cesium.BingMapsImageryProvider.fromUrl('https://dev.virtualearth.net', {
                        key: 'AqTGBsziZHIJYYxgivLBf0hVdrAk9mWO5cQcb8Yux8sW5M8c8opEC2lZqKR1ZZXf',
                        mapStyle: Cesium.BingMapsStyle.AERIAL,
                        maximumLevel: 18
                    });
                    console.log('‚úÖ Bing Maps loaded successfully');
                    console.log('üîß Provider ready state:', imageryProvider.ready);
                } catch (bingError) {
                    console.warn('Bing Maps failed, trying OpenStreetMap...', bingError.message);
                    
                    // Option 2: OpenStreetMap (always works)
                    console.log('üîß Fallback to OpenStreetMap');
                    imageryProvider = new Cesium.OpenStreetMapImageryProvider({
                        url: 'https://tile.openstreetmap.org/',
                        maximumLevel: 18
                    });
                    console.log('‚úÖ OpenStreetMap loaded successfully');
                }

                document.getElementById('status').textContent = 'Creating Cesium viewer...';
                console.log('üîß Creating Cesium viewer with minimal config...');

                // Create viewer with minimal configuration
                const viewer = new Cesium.Viewer('cesiumContainer', {
                    imageryProvider: imageryProvider,
                    baseLayerPicker: false,
                    geocoder: false,
                    homeButton: false,
                    sceneModePicker: false,
                    navigationHelpButton: false,
                    animation: false,
                    timeline: false,
                    fullscreenButton: false,
                    vrButton: false,
                    selectionIndicator: false,
                    infoBox: false
                });
                
                console.log('üîß Viewer created:', !!viewer);
                console.log('üîß Scene ready:', !!viewer.scene);
                console.log('üîß Globe ready:', !!viewer.scene.globe);

                // Basic globe configuration
                console.log('üîß Configuring globe settings...');
                viewer.scene.globe.enableLighting = false;
                viewer.scene.fog.enabled = false;
                console.log('üîß Globe lighting disabled, fog disabled');
                
                console.log('‚úÖ Viewer created successfully');
                document.getElementById('status').textContent = '‚úÖ Globe loaded successfully!';
                
                // Final validation
                console.log('üîß Final viewer state:');
                console.log('üîß - Container:', document.getElementById('cesiumContainer'));
                console.log('üîß - Canvas present:', !!viewer.canvas);
                console.log('üîß - Rendering:', !viewer.useDefaultRenderLoop || viewer.renderingEnabled);
                
                // Simple camera position
                viewer.camera.setView({
                    destination: Cesium.Cartesian3.fromDegrees(-0.1276, 51.5074, 15000000) // London area
                });

                // Hide status after 3 seconds
                setTimeout(() => {
                    document.getElementById('status').style.display = 'none';
                }, 3000);

            } catch (error) {
                console.error('‚ùå Minimal globe initialization failed:', error);
                document.getElementById('status').textContent = '‚ùå Error: ' + error.message;
                document.getElementById('status').style.background = 'rgba(255,0,0,0.8)';
            }
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', initializeMinimalGlobe);
    </script>
</body>
</html>